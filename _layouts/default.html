<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
  <meta name="description" content="{{ page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
  <link rel="canonical" href="{{ page.url | replace:'index.html', '' | absolute_url }}">
  <link rel="alternate" type="application/rss+xml" title="{{ site.title | escape }} Feed"
    href="{{ '/feed.xml' | absolute_url }}">
  {% if site.favicon and site.favicon != "" %}
  <link rel="shortcut icon" href="{{ site.favicon | relative_url }}" type="image/png" />
  {% endif %}
  <!-- Modern Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link href="{{ '/assets/css/temp-style.css' | relative_url }}" rel="stylesheet">
  
  <!-- Meta tags for better SEO and social sharing -->
  <meta property="og:title" content="{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}">
  <meta property="og:description" content="{{ page.description | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">
  <meta property="og:type" content="website">
  <meta property="og:url" content="{{ page.url | replace:'index.html', '' | absolute_url }}">
  <meta name="twitter:card" content="summary_large_image">
</head>
<body>
  <!-- 页面加载动画 -->
  <div id="page-loader" class="page-loader">
    <div class="loader-content">
      <div class="cloud-container">
        <div class="cloud cloud-1"></div>
        <div class="cloud cloud-2"></div>
        <div class="cloud cloud-3"></div>
        <div class="cloud cloud-4"></div>
      </div>
      <div class="loader-text">
        <h2>云游君的小站</h2>
        <p>正在为您准备精彩内容...</p>
      </div>
      <div class="loading-progress">
        <div class="progress-bar"></div>
      </div>
    </div>
  </div>

  <div id="page" class="site page-hidden">
    {% include header.html %}
    <main class="site-main">
      {{content}}
    </main>
    {% include footer.html %}
  </div><!-- .site -->

  <!-- Scripts -->
  {% if site.google_analytics %}
    {% include google_analytics.html %}
  {% endif %}
  <script src="{{ '/assets/js/plugins.js' | relative_url }}"></script>
  <script src="{{ '/assets/js/custom.js' | relative_url }}"></script>
  
  <!-- 移动端菜单脚本 -->
  <script>
    (function() {
      const menuOpen = document.getElementById('menu-open');
      const menuClose = document.getElementById('menu-close');
      const navigation = document.getElementById('site-navigation');
      const body = document.body;
      
      if (menuOpen && menuClose && navigation) {
        menuOpen.addEventListener('click', function() {
          navigation.classList.add('menu-open');
          body.classList.add('menu--opened');
        });
        
        menuClose.addEventListener('click', function() {
          navigation.classList.remove('menu-open');
          body.classList.remove('menu--opened');
        });
        
        // 点击导航外部区域关闭菜单
        navigation.addEventListener('click', function(e) {
          if (e.target === navigation) {
            navigation.classList.remove('menu-open');
            body.classList.remove('menu--opened');
          }
        });
      }
      
      // 头部滚动效果
      const header = document.getElementById('site-header');
      let lastScroll = 0;
      
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 100) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        
        lastScroll = currentScroll;
      });
    })();
  </script>
  
  <!-- 加载动画脚本 -->
  <script>
    (function() {
      const loader = document.getElementById('page-loader');
      const site = document.getElementById('page');
      const progressBar = document.querySelector('.progress-bar');
      
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 95) progress = 95;
        progressBar.style.width = progress + '%';
      }, 100);
      
      // 模拟加载进程，实际中可以基于资源加载情况
      window.addEventListener('load', function() {
        clearInterval(progressInterval);
        progressBar.style.width = '100%';
        
        setTimeout(function() {
          loader.classList.add('loader-hide');
          site.classList.remove('page-hidden');
          site.classList.add('page-show');
        }, 500);
        
        setTimeout(function() {
          loader.style.display = 'none';
        }, 1500);
      });
      
      // 防止加载时间过长，设置最大等待时间
      setTimeout(function() {
        if (loader && loader.style.display !== 'none') {
          clearInterval(progressInterval);
          progressBar.style.width = '100%';
          loader.classList.add('loader-hide');
          site.classList.remove('page-hidden');
          site.classList.add('page-show');
          
          setTimeout(function() {
            loader.style.display = 'none';
          }, 1000);
        }
      }, 3000);
    })();
  </script>

</body>
</html>