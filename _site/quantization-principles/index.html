<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é‡åŒ–çš„æ ¸å¿ƒåŸç†</title>
  <meta name="description" content="æ·±å…¥è®²è§£ç¥ç»ç½‘ç»œé‡åŒ–çš„æ•°å­¦åŸç†ã€æƒé‡é‡åŒ–è¿ç®—æœºåˆ¶">
  <link rel="canonical" href="https://comcloud.github.io/quantization-principles/">
  <link rel="alternate" type="application/rss+xml" title="æˆéƒ½çŠ€ç‰› Feed"
    href="https://comcloud.github.io/feed.xml">
  
  <link rel="shortcut icon" href="/images/favicon.png" type="image/png" />
  
  <!-- Modern Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
  
  <!-- Styles -->
  <link href="/assets/css/temp-style.css" rel="stylesheet">
  
  <!-- Meta tags for better SEO and social sharing -->
  <meta property="og:title" content="é‡åŒ–çš„æ ¸å¿ƒåŸç†">
  <meta property="og:description" content="æ·±å…¥è®²è§£ç¥ç»ç½‘ç»œé‡åŒ–çš„æ•°å­¦åŸç†ã€æƒé‡é‡åŒ–è¿ç®—æœºåˆ¶">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://comcloud.github.io/quantization-principles/">
  <meta name="twitter:card" content="summary_large_image">
</head>
<body>
  <!-- é¡µé¢åŠ è½½åŠ¨ç”» -->
  <div id="page-loader" class="page-loader">
    <div class="loader-content">
      <div class="cloud-container">
        <div class="cloud left"></div>
        <div class="cloud right"></div>
      </div>
      <div class="loader-text">
        <h2>äº‘æ¸¸å›çš„å°ç«™</h2>
        <p>æ­£åœ¨ä¸ºæ‚¨å‡†å¤‡ç²¾å½©å†…å®¹...</p>
      </div>
      <div class="loading-progress">
        <div class="progress-bar"></div>
      </div>
    </div>
  </div>

  <div id="page" class="site page-hidden">
    <header class="site-header" id="site-header">
  <div class="container">
    
    <div class="site-title">
      <a href="/">
        æˆéƒ½çŠ€ç‰›
      </a>
    </div>
    
    
    <nav class="site-navigation" id="site-navigation">
      <div class="site-navigation-wrap">
        <ul class="menu">
          
          
          
          
            
            
            <li class="menu-item">
              <a href="/" class="">
                Home
              </a>
            </li>
          
            
            
            <li class="menu-item">
              <a href="/personal/" class="">
                Personal
              </a>
            </li>
          
            
            
            <li class="menu-item">
              <a href="/articles/" class="">
                Articles
              </a>
            </li>
          
            
            
            <li class="menu-item">
              <a href="https://github.com/comcloud" class="">
                comcloud
              </a>
            </li>
          
        </ul>
        <button id="menu-close" class="menu-toggle">
          <span class="visually-hidden">å…³é—­èœå•</span>
          âœ•
        </button>
      </div>
    </nav>
    
    <button id="menu-open" class="menu-toggle">
      <span class="visually-hidden">æ‰“å¼€èœå•</span>
      â˜°
    </button>
  </div>
</header>


    <main class="site-main">
      <main class="main-content fadeInDown delay_075s">
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">é‡åŒ–çš„æ ¸å¿ƒåŸç†</h1>
      
      <p class="post-description">æ·±å…¥è®²è§£ç¥ç»ç½‘ç»œé‡åŒ–çš„æ•°å­¦åŸç†ã€æƒé‡é‡åŒ–è¿ç®—æœºåˆ¶</p>
      
      
      <div class="post-meta">
        <time class="post-date">August 3, 2024</time>
      </div>
      
      
    </header><!-- .post-header -->
    
    <div class="post-content">
      <h1 id="é‡åŒ–çš„æ ¸å¿ƒåŸç†æµ®ç‚¹æ•°åˆ°æ•´æ•°çš„æ˜ å°„">é‡åŒ–çš„æ ¸å¿ƒåŸç†ï¼šæµ®ç‚¹æ•°åˆ°æ•´æ•°çš„æ˜ å°„</h1>

<p>é‡åŒ–çš„åŸºæœ¬æ€æƒ³æ˜¯å°†ç¥ç»ç½‘ç»œä¸­é€šå¸¸ä½¿ç”¨çš„æµ®ç‚¹æ•°ï¼ˆå¦‚FP32ï¼Œ32ä½æµ®ç‚¹æ•°ï¼‰è¡¨ç¤ºçš„æƒé‡å’Œæ¿€æ´»å€¼ï¼Œæ˜ å°„åˆ°ä½ä½å®½çš„æ•´æ•°ï¼ˆå¦‚INT8ï¼Œ8ä½æ•´æ•°ï¼‰è¡¨ç¤ºã€‚è¿™ä¸ªæ˜ å°„è¿‡ç¨‹éœ€è¦å®šä¹‰ä¸€ä¸ª<strong>é‡åŒ–å‡½æ•°</strong>å’Œä¸€ä¸ª<strong>åé‡åŒ–å‡½æ•°</strong>ã€‚</p>

<p>æœ€å¸¸è§çš„é‡åŒ–æ–¹æ³•æ˜¯<strong>çº¿æ€§å‡åŒ€é‡åŒ– (Linear Uniform Quantization)</strong>ï¼Œå®ƒé€šè¿‡ä¸€ä¸ª<strong>ç¼©æ”¾å› å­ (Scale Factor, S)</strong> å’Œä¸€ä¸ª<strong>é›¶ç‚¹ (Zero Point, Z)</strong> æ¥å®ç°æµ®ç‚¹æ•°å’Œæ•´æ•°ä¹‹é—´çš„çº¿æ€§æ˜ å°„ã€‚</p>

<h2 id="1-é‡åŒ–å‚æ•°-s-å’Œ-z-çš„ç¡®å®š">1. é‡åŒ–å‚æ•° (S å’Œ Z) çš„ç¡®å®š</h2>

<p>åœ¨è¿›è¡Œé‡åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šæµ®ç‚¹æ•°èŒƒå›´ï¼ˆ$F_{min}$,$F_{max}$ï¼‰å’Œæ•´æ•°èŒƒå›´ï¼ˆ$Q_{min}$,$Q_{max}$ï¼‰ã€‚</p>

<ul>
  <li><strong>æ•´æ•°èŒƒå›´</strong>é€šå¸¸æ˜¯å›ºå®šçš„ã€‚ä¾‹å¦‚ï¼Œå¯¹äº 8 ä½æ— ç¬¦å·æ•´æ•° <code class="language-plaintext highlighter-rouge">(UINT8)</code> $Q_{min}=0$,$Q_{max}=255$ï¼›å¯¹äº 8 ä½æœ‰ç¬¦å·æ•´æ•° <code class="language-plaintext highlighter-rouge">(INT8)</code>ï¼Œ$Q_{min}=-128$,$Q_{max}=127$ã€‚</li>
  <li><strong>æµ®ç‚¹æ•°èŒƒå›´</strong>åˆ™éœ€è¦ä»æ¨¡å‹ä¸­è·å–ã€‚</li>
</ul>

<p>ä¸€æ—¦ç¡®å®šäº†æµ®ç‚¹æ•°çš„èŒƒå›´ï¼Œå°±å¯ä»¥è®¡ç®— S å’Œ Zï¼š</p>

<ul>
  <li>
    <p>ç¼©æ”¾å› å­ S (Scale Factor):
\(S=(Q_{max}âˆ’Q_{min})/ (F_{max}âˆ’F_{min})\)</p>
  </li>
  <li>
    <p>é›¶ç‚¹ Z (Zero Point):
\(Z=Q_{min}âˆ’S \\times F_{min}\)</p>
  </li>
</ul>

<h2 id="2-é‡åŒ–è¿‡ç¨‹-quantization">2. é‡åŒ–è¿‡ç¨‹ (Quantization)</h2>

<p>å°†ä¸€ä¸ªæµ®ç‚¹æ•° FP é‡åŒ–ä¸ºæ•´æ•° Q çš„å…¬å¼ï¼š</p>

<p>[Q=round(S \times FP+Z)]</p>

<p>å…¶ä¸­ round è¡¨ç¤ºå››èˆäº”å…¥ã€‚</p>

<h2 id="3-åé‡åŒ–è¿‡ç¨‹-dequantization">3. åé‡åŒ–è¿‡ç¨‹ (Dequantization)</h2>

<p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸ºäº†è¿›è¡Œè®¡ç®—æˆ–è¾“å‡ºï¼Œéœ€è¦å°†æ•´æ•° Q åé‡åŒ–å›æµ®ç‚¹æ•°ï¼š</p>

<p>[FP_{reconstructed}=(Qâˆ’Z) \times S]</p>

<p><strong>ä¸ºä»€ä¹ˆéœ€è¦é›¶ç‚¹ Zï¼Ÿ</strong></p>

<p>é›¶ç‚¹çš„å­˜åœ¨æ˜¯ä¸ºäº†ç¡®ä¿æµ®ç‚¹æ•° 0.0 èƒ½å¤Ÿç²¾ç¡®åœ°æ˜ å°„åˆ°ä¸€ä¸ªæ•´æ•°å€¼ï¼Œè¿™å¯¹äºæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ ReLUï¼Œå…¶ä¸­å¤§é‡å€¼ä¸º 0ï¼‰å’Œç¨€ç–æƒé‡çŸ©é˜µéå¸¸é‡è¦ï¼Œå¯ä»¥é¿å…é‡åŒ–è¯¯å·®ç´¯ç§¯ã€‚</p>

<h2 id="æƒé‡é‡åŒ–è¿ç®—">æƒé‡é‡åŒ–è¿ç®—</h2>

<p>æ¨¡å‹å‚æ•°ï¼ˆæƒé‡ï¼‰çš„é‡åŒ–æ¯”æ¿€æ´»å€¼ç›¸å¯¹ç®€å•ï¼Œå› ä¸ºæƒé‡æ˜¯å›ºå®šçš„ã€‚ä¸»è¦æœ‰ä¸¤ç§ç­–ç•¥ï¼š</p>

<h3 id="ç¦»çº¿é‡åŒ–-ptq---post-training-quantization">ç¦»çº¿é‡åŒ– (PTQ - Post-Training Quantization)</h3>

<p>è¿™æ˜¯æœ€å¸¸è§çš„æƒé‡é‡åŒ–æ–¹å¼ï¼š</p>

<ol>
  <li>åŠ è½½é¢„è®­ç»ƒçš„ FP32 æ¨¡å‹</li>
  <li>è®¡ç®—æ¯ä¸ªæƒé‡å¼ é‡çš„æœ€å°å€¼å’Œæœ€å¤§å€¼</li>
  <li>æ ¹æ®èŒƒå›´è®¡ç®—å¯¹åº”çš„ S å’Œ Z</li>
  <li>å°†æ¯ä¸ªæµ®ç‚¹æƒé‡é‡åŒ–ä¸ºæ•´æ•°</li>
  <li>å­˜å‚¨é‡åŒ–åçš„æ¨¡å‹</li>
</ol>

<h3 id="åœ¨çº¿é‡åŒ–-qat---quantization-aware-training">åœ¨çº¿é‡åŒ– (QAT - Quantization-Aware Training)</h3>

<p>åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¼•å…¥é‡åŒ–æ“ä½œçš„æ¨¡æ‹Ÿï¼š</p>

<ol>
  <li>åœ¨è®­ç»ƒå›¾ä¸­æ’å…¥ä¼ªé‡åŒ–èŠ‚ç‚¹</li>
  <li>æ‰§è¡Œé‡åŒ–â†’åé‡åŒ–æ“ä½œæ¥æ¨¡æ‹Ÿé‡åŒ–è¯¯å·®</li>
  <li>æ¨¡å‹å­¦ä¹ é€‚åº”é‡åŒ–å¸¦æ¥çš„è¯¯å·®</li>
  <li>éƒ¨ç½²æ—¶ç›´æ¥è¿›è¡Œæœ€ç»ˆé‡åŒ–</li>
</ol>

<hr />

<p>ğŸ“š <strong>ç›¸å…³æ–‡ç« æ¨èï¼š</strong></p>
<ul>
  <li><a href="/llama-series/">Llamaç³»åˆ—å¤§æ¨¡å‹è§£æ</a></li>
  <li><a href="/deepseek-intro/">DeepSeekæ¨¡å‹ä»‹ç»</a></li>
  <li><a href="/blog/">å›åˆ°åšå®¢é¦–é¡µ</a></li>
</ul>

    </div><!-- .post-content -->
    
    
    <footer class="post-footer">
      <div class="post-tags">
        <span class="tags-label">Tags:</span>
        
        <a href="/tags#qwen" class="tag-link">Qwen</a>, 
        
        <a href="/tags#%E9%87%8F%E5%8C%96" class="tag-link">é‡åŒ–</a>, 
        
        <a href="/tags#%E6%95%B0%E5%AD%A6%E5%8E%9F%E7%90%86" class="tag-link">æ•°å­¦åŸç†</a>, 
        
        <a href="/tags#%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0" class="tag-link">æ·±åº¦å­¦ä¹ </a>
        
      </div>
    </footer>
    
  </article><!-- .post -->
</main><!-- .site-main -->
    </main>
    <footer class="site-footer">
  <div class="offsite-links">
    
      
<a href="https://twitter.com/" target="_blank" rel="noopener">
  <span class="fa-twitter" aria-hidden="true"></span>
  <span class="screen-reader-text">Twitter</span>
</a>

<a href="https://github.com/" target="_blank" rel="noopener">
  <span class="fa-github" aria-hidden="true"></span>
  <span class="screen-reader-text">GitHub</span>
</a>

<a href="https://www.instagram.com/" target="_blank" rel="noopener">
  <span class="fa-instagram" aria-hidden="true"></span>
  <span class="screen-reader-text">Instagram</span>
</a>

<a href="https://www.linkedin.com/" target="_blank" rel="noopener">
  <span class="fa-linkedin" aria-hidden="true"></span>
  <span class="screen-reader-text">LinkedIn</span>
</a>

    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      <p>Â© Scriptor all rights reserved. Theme by <a href="https://www.justgoodthemes.com">JustGoodThemes</a>.</p>

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

  </div><!-- .site -->

  <!-- Scripts -->
  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>
  
  <script src="/assets/js/plugins.js"></script>
  <script src="/assets/js/custom.js"></script>
  
  <!-- ç§»åŠ¨ç«¯èœå•è„šæœ¬ -->
  <script>
    (function() {
      const menuOpen = document.getElementById('menu-open');
      const menuClose = document.getElementById('menu-close');
      const navigation = document.getElementById('site-navigation');
      const body = document.body;
      
      if (menuOpen && menuClose && navigation) {
        menuOpen.addEventListener('click', function() {
          navigation.classList.add('menu-open');
          body.classList.add('menu--opened');
        });
        
        menuClose.addEventListener('click', function() {
          navigation.classList.remove('menu-open');
          body.classList.remove('menu--opened');
        });
        
        // ç‚¹å‡»å¯¼èˆªå¤–éƒ¨åŒºåŸŸå…³é—­èœå•
        navigation.addEventListener('click', function(e) {
          if (e.target === navigation) {
            navigation.classList.remove('menu-open');
            body.classList.remove('menu--opened');
          }
        });
      }
      
      // å¤´éƒ¨æ»šåŠ¨æ•ˆæœ
      const header = document.getElementById('site-header');
      let lastScroll = 0;
      
      window.addEventListener('scroll', function() {
        const currentScroll = window.pageYOffset;
        
        if (currentScroll > 100) {
          header.classList.add('scrolled');
        } else {
          header.classList.remove('scrolled');
        }
        
        lastScroll = currentScroll;
      });
    })();
  </script>
  
  <!-- åŠ è½½åŠ¨ç”»è„šæœ¬ -->
  <script>
    (function() {
      const loader = document.getElementById('page-loader');
      const site = document.getElementById('page');
      const progressBar = document.querySelector('.progress-bar');
      
      let progress = 0;
      const progressInterval = setInterval(() => {
        progress += Math.random() * 15;
        if (progress > 95) progress = 95;
        progressBar.style.width = progress + '%';
      }, 100);
      
      // æ¨¡æ‹ŸåŠ è½½è¿›ç¨‹ï¼Œå®é™…ä¸­å¯ä»¥åŸºäºèµ„æºåŠ è½½æƒ…å†µ
      window.addEventListener('load', function() {
        clearInterval(progressInterval);
        progressBar.style.width = '100%';
        
        setTimeout(function() {
          loader.classList.add('loader-hide');
          site.classList.remove('page-hidden');
          site.classList.add('page-show');
        }, 500);
        
        setTimeout(function() {
          loader.style.display = 'none';
        }, 1500);
      });
      
      // é˜²æ­¢åŠ è½½æ—¶é—´è¿‡é•¿ï¼Œè®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é—´
      setTimeout(function() {
        if (loader && loader.style.display !== 'none') {
          clearInterval(progressInterval);
          progressBar.style.width = '100%';
          loader.classList.add('loader-hide');
          site.classList.remove('page-hidden');
          site.classList.add('page-show');
          
          setTimeout(function() {
            loader.style.display = 'none';
          }, 1000);
        }
      }, 3000);
    })();
  </script>

</body>
</html>